<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 16 More tests for relationships (Diagnostics) | RGuide</title>
  <meta name="description" content="Teach yourself R in DATA1001/DATA1901" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 16 More tests for relationships (Diagnostics) | RGuide" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Teach yourself R in DATA1001/DATA1901" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 16 More tests for relationships (Diagnostics) | RGuide" />
  
  <meta name="twitter:description" content="Teach yourself R in DATA1001/DATA1901" />
  

<meta name="author" content="DATA1001/DATA1901" />


<meta name="date" content="2020-11-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="testsforrelationships.html"/>
<link rel="next" href="faq.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan, pre.js');
  rCodeBlocks.each(function() {

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide Code' : 'Show Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Show Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide Code');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}
.open > .dropdown-menu {
    display: block;
}
.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 16px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<script>
document.write('<div class="btn-group pull-right" style="position: absolute; top: 10%; right: 2%; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Show All Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 120px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>')
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/styles.css" type="text/css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.6/css/all.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Aim</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction to R/RStudio</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#find-rstudio-on-campus"><i class="fa fa-check"></i><b>1.1</b> Find RStudio (on campus)</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#install-r-and-rstudio-on-your-own-computer"><i class="fa fa-check"></i><b>1.2</b> Install R and RStudio (on your own computer)</a><ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#install-r"><i class="fa fa-check"></i><b>1.2.1</b> Install R</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#install-rstudio"><i class="fa fa-check"></i><b>1.2.2</b> Install RStudio</a></li>
<li class="chapter" data-level="1.2.3" data-path="intro.html"><a href="intro.html#open-rstudio"><i class="fa fa-check"></i><b>1.2.3</b> Open RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#using-rstudio-if-you-dont-have-a-computer-or-its-not-working"><i class="fa fa-check"></i><b>1.3</b> Using RStudio (if you don’t have a computer, or it’s not working)</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="gettingstarted.html"><a href="gettingstarted.html"><i class="fa fa-check"></i><b>2</b> Getting started with RStudio</a><ul>
<li class="chapter" data-level="2.1" data-path="gettingstarted.html"><a href="gettingstarted.html#use-rstudio-as-a-calculator"><i class="fa fa-check"></i><b>2.1</b> Use RStudio as a calculator</a></li>
<li class="chapter" data-level="2.2" data-path="gettingstarted.html"><a href="gettingstarted.html#experiment-with-data-in-r"><i class="fa fa-check"></i><b>2.2</b> Experiment with data in R</a></li>
<li class="chapter" data-level="2.3" data-path="gettingstarted.html"><a href="gettingstarted.html#get-organised-course-folder"><i class="fa fa-check"></i><b>2.3</b> Get organised: course folder</a></li>
<li class="chapter" data-level="2.4" data-path="gettingstarted.html"><a href="gettingstarted.html#knit-a-given-rmarkdown-file"><i class="fa fa-check"></i><b>2.4</b> Knit a given RMarkdown file</a></li>
<li class="chapter" data-level="2.5" data-path="gettingstarted.html"><a href="gettingstarted.html#neat-workflow"><i class="fa fa-check"></i><b>2.5</b> Neat workflow</a></li>
<li class="chapter" data-level="2.6" data-path="gettingstarted.html"><a href="gettingstarted.html#install-packages"><i class="fa fa-check"></i><b>2.6</b> Install packages</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="importdata.html"><a href="importdata.html"><i class="fa fa-check"></i><b>3</b> Import data into R</a><ul>
<li class="chapter" data-level="3.1" data-path="importdata.html"><a href="importdata.html#from-the-internet"><i class="fa fa-check"></i><b>3.1</b> From the internet</a></li>
<li class="chapter" data-level="3.2" data-path="importdata.html"><a href="importdata.html#from-your-folder"><i class="fa fa-check"></i><b>3.2</b> From your folder</a></li>
<li class="chapter" data-level="3.3" data-path="importdata.html"><a href="importdata.html#from-a-data-subfolder"><i class="fa fa-check"></i><b>3.3</b> From a data subfolder</a></li>
<li class="chapter" data-level="3.4" data-path="importdata.html"><a href="importdata.html#using-file.choose-and-working-directories"><i class="fa fa-check"></i><b>3.4</b> Using file.choose() and working directories</a></li>
<li class="chapter" data-level="3.5" data-path="importdata.html"><a href="importdata.html#using-import-dataset"><i class="fa fa-check"></i><b>3.5</b> Using Import dataset</a></li>
<li class="chapter" data-level="3.6" data-path="importdata.html"><a href="importdata.html#note-about-excel-files"><i class="fa fa-check"></i><b>3.6</b> Note about Excel files</a></li>
<li class="chapter" data-level="3.7" data-path="importdata.html"><a href="importdata.html#more-info"><i class="fa fa-check"></i><b>3.7</b> More info</a></li>
<li class="chapter" data-level="3.8" data-path="importdata.html"><a href="importdata.html#data-wrangling"><i class="fa fa-check"></i><b>3.8</b> Data Wrangling **</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="structure-of-data.html"><a href="structure-of-data.html"><i class="fa fa-check"></i><b>4</b> Structure of data</a><ul>
<li class="chapter" data-level="4.1" data-path="structure-of-data.html"><a href="structure-of-data.html#classify-variables"><i class="fa fa-check"></i><b>4.1</b> Classify variables</a></li>
<li class="chapter" data-level="4.2" data-path="structure-of-data.html"><a href="structure-of-data.html#isolate-a-variable"><i class="fa fa-check"></i><b>4.2</b> Isolate a variable</a></li>
<li class="chapter" data-level="4.3" data-path="structure-of-data.html"><a href="structure-of-data.html#select-subset"><i class="fa fa-check"></i><b>4.3</b> Select subset</a></li>
<li class="chapter" data-level="4.4" data-path="structure-of-data.html"><a href="structure-of-data.html#change-classification"><i class="fa fa-check"></i><b>4.4</b> Change classification</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="graphicalsummaries.html"><a href="graphicalsummaries.html"><i class="fa fa-check"></i><b>5</b> Graphical Summaries</a><ul>
<li class="chapter" data-level="5.1" data-path="graphicalsummaries.html"><a href="graphicalsummaries.html#barplot"><i class="fa fa-check"></i><b>5.1</b> Barplot</a></li>
<li class="chapter" data-level="5.2" data-path="graphicalsummaries.html"><a href="graphicalsummaries.html#histogram"><i class="fa fa-check"></i><b>5.2</b> Histogram</a></li>
<li class="chapter" data-level="5.3" data-path="graphicalsummaries.html"><a href="graphicalsummaries.html#boxplot"><i class="fa fa-check"></i><b>5.3</b> Boxplot</a></li>
<li class="chapter" data-level="5.4" data-path="graphicalsummaries.html"><a href="graphicalsummaries.html#mosaicplot"><i class="fa fa-check"></i><b>5.4</b> Mosaicplot</a></li>
<li class="chapter" data-level="5.5" data-path="graphicalsummaries.html"><a href="graphicalsummaries.html#scatterplot"><i class="fa fa-check"></i><b>5.5</b> Scatterplot</a></li>
<li class="chapter" data-level="5.6" data-path="graphicalsummaries.html"><a href="graphicalsummaries.html#ggplot"><i class="fa fa-check"></i><b>5.6</b> ggplot</a><ul>
<li class="chapter" data-level="5.6.1" data-path="graphicalsummaries.html"><a href="graphicalsummaries.html#barplot-1"><i class="fa fa-check"></i><b>5.6.1</b> Barplot</a></li>
<li class="chapter" data-level="5.6.2" data-path="graphicalsummaries.html"><a href="graphicalsummaries.html#histogram-1"><i class="fa fa-check"></i><b>5.6.2</b> Histogram</a></li>
<li class="chapter" data-level="5.6.3" data-path="graphicalsummaries.html"><a href="graphicalsummaries.html#boxplot-1"><i class="fa fa-check"></i><b>5.6.3</b> Boxplot</a></li>
<li class="chapter" data-level="5.6.4" data-path="graphicalsummaries.html"><a href="graphicalsummaries.html#scatterplot-1"><i class="fa fa-check"></i><b>5.6.4</b> Scatterplot</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="graphicalsummaries.html"><a href="graphicalsummaries.html#plotly"><i class="fa fa-check"></i><b>5.7</b> plotly **</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="numericalsummaries.html"><a href="numericalsummaries.html"><i class="fa fa-check"></i><b>6</b> Numerical Summaries</a><ul>
<li class="chapter" data-level="6.1" data-path="numericalsummaries.html"><a href="numericalsummaries.html#frequency-and-contingency-tables"><i class="fa fa-check"></i><b>6.1</b> Frequency and contingency tables</a></li>
<li class="chapter" data-level="6.2" data-path="numericalsummaries.html"><a href="numericalsummaries.html#mean-and-median"><i class="fa fa-check"></i><b>6.2</b> Mean and median</a></li>
<li class="chapter" data-level="6.3" data-path="numericalsummaries.html"><a href="numericalsummaries.html#standard-deviation-sd"><i class="fa fa-check"></i><b>6.3</b> Standard deviation (SD)</a></li>
<li class="chapter" data-level="6.4" data-path="numericalsummaries.html"><a href="numericalsummaries.html#interquartile-range-iqr"><i class="fa fa-check"></i><b>6.4</b> Interquartile range (IQR)</a></li>
<li class="chapter" data-level="6.5" data-path="numericalsummaries.html"><a href="numericalsummaries.html#summary"><i class="fa fa-check"></i><b>6.5</b> Summary</a></li>
<li class="chapter" data-level="6.6" data-path="numericalsummaries.html"><a href="numericalsummaries.html#linear-correlation"><i class="fa fa-check"></i><b>6.6</b> Linear Correlation</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="normalmodel.html"><a href="normalmodel.html"><i class="fa fa-check"></i><b>7</b> Normal model</a><ul>
<li class="chapter" data-level="7.1" data-path="normalmodel.html"><a href="normalmodel.html#plot-curve"><i class="fa fa-check"></i><b>7.1</b> Plot curve</a></li>
<li class="chapter" data-level="7.2" data-path="normalmodel.html"><a href="normalmodel.html#plot-area-under-curve-ext"><i class="fa fa-check"></i><b>7.2</b> Plot area under curve (Ext)</a></li>
<li class="chapter" data-level="7.3" data-path="normalmodel.html"><a href="normalmodel.html#add-normal-to-a-histogram"><i class="fa fa-check"></i><b>7.3</b> Add normal to a histogram</a></li>
<li class="chapter" data-level="7.4" data-path="normalmodel.html"><a href="normalmodel.html#probabilities-standard-normal"><i class="fa fa-check"></i><b>7.4</b> Probabilities: Standard normal</a><ul>
<li class="chapter" data-level="7.4.1" data-path="normalmodel.html"><a href="normalmodel.html#lower-tail"><i class="fa fa-check"></i><b>7.4.1</b> Lower tail</a></li>
<li class="chapter" data-level="7.4.2" data-path="normalmodel.html"><a href="normalmodel.html#upper-tail"><i class="fa fa-check"></i><b>7.4.2</b> Upper tail</a></li>
<li class="chapter" data-level="7.4.3" data-path="normalmodel.html"><a href="normalmodel.html#interval"><i class="fa fa-check"></i><b>7.4.3</b> Interval</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="normalmodel.html"><a href="normalmodel.html#probabilities-general-normal"><i class="fa fa-check"></i><b>7.5</b> Probabilities: General normal</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="linearmodel.html"><a href="linearmodel.html"><i class="fa fa-check"></i><b>8</b> Linear model</a><ul>
<li class="chapter" data-level="8.1" data-path="linearmodel.html"><a href="linearmodel.html#scatter-plot"><i class="fa fa-check"></i><b>8.1</b> Scatter plot</a></li>
<li class="chapter" data-level="8.2" data-path="linearmodel.html"><a href="linearmodel.html#correlation-coefficient"><i class="fa fa-check"></i><b>8.2</b> Correlation coefficient</a></li>
<li class="chapter" data-level="8.3" data-path="linearmodel.html"><a href="linearmodel.html#regression-line"><i class="fa fa-check"></i><b>8.3</b> Regression line</a></li>
<li class="chapter" data-level="8.4" data-path="linearmodel.html"><a href="linearmodel.html#residual-plot"><i class="fa fa-check"></i><b>8.4</b> Residual plot</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="nonlinearmodel.html"><a href="nonlinearmodel.html"><i class="fa fa-check"></i><b>9</b> Non-Linear Model</a><ul>
<li class="chapter" data-level="9.1" data-path="nonlinearmodel.html"><a href="nonlinearmodel.html#transformation"><i class="fa fa-check"></i><b>9.1</b> Transformation</a></li>
<li class="chapter" data-level="9.2" data-path="nonlinearmodel.html"><a href="nonlinearmodel.html#fit-non-linear-model-ext"><i class="fa fa-check"></i><b>9.2</b> Fit non-linear model (Ext)</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="simulatechance.html"><a href="simulatechance.html"><i class="fa fa-check"></i><b>10</b> Simulate chance</a><ul>
<li class="chapter" data-level="10.1" data-path="simulatechance.html"><a href="simulatechance.html#set-seed"><i class="fa fa-check"></i><b>10.1</b> Set seed</a></li>
<li class="chapter" data-level="10.2" data-path="simulatechance.html"><a href="simulatechance.html#sample-coin"><i class="fa fa-check"></i><b>10.2</b> Sample (Coin)</a></li>
<li class="chapter" data-level="10.3" data-path="simulatechance.html"><a href="simulatechance.html#sample-dice"><i class="fa fa-check"></i><b>10.3</b> Sample (Dice)</a></li>
<li><a href="simulatechance.html#function-binomial-model"><span class="toc-section-number">10.4</span> Function **
## Binomial Model *</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="boxmodel.html"><a href="boxmodel.html"><i class="fa fa-check"></i><b>11</b> Simulate chance variability (box model)</a><ul>
<li><a href="boxmodel.html#draw-the-box-model-in-r-sample-sum-ev-se-simulate-the-sample-sum-use-normal-model-for-sample-sum-sample-mean-ev-se-use-normal-model-for-sample-mean"><span class="toc-section-number">11.1</span> Draw the box model in R **
## Sample Sum (EV &amp; SE)
## Simulate the Sample Sum
## Use Normal model for Sample Sum
## Sample Mean (EV &amp; SE)
## Use Normal model for Sample Mean</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="samplesurveys.html"><a href="samplesurveys.html"><i class="fa fa-check"></i><b>12</b> Sample surveys</a><ul>
<li class="chapter" data-level="12.1" data-path="samplesurveys.html"><a href="samplesurveys.html#box-model-assuming-replacement"><i class="fa fa-check"></i><b>12.1</b> Box model (assuming replacement)</a></li>
<li class="chapter" data-level="12.2" data-path="samplesurveys.html"><a href="samplesurveys.html#bootstrapping-a-box-model"><i class="fa fa-check"></i><b>12.2</b> Bootstrapping a box model</a></li>
<li class="chapter" data-level="12.3" data-path="samplesurveys.html"><a href="samplesurveys.html#confidence-intervals-for-population-proportion"><i class="fa fa-check"></i><b>12.3</b> Confidence Intervals for population proportion</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="testforproportion.html"><a href="testforproportion.html"><i class="fa fa-check"></i><b>13</b> Test for a proportion (using simulation)</a><ul>
<li class="chapter" data-level="13.1" data-path="testforproportion.html"><a href="testforproportion.html#simple-balanced-box"><i class="fa fa-check"></i><b>13.1</b> Simple balanced box</a></li>
<li class="chapter" data-level="13.2" data-path="testforproportion.html"><a href="testforproportion.html#unbalanced-box"><i class="fa fa-check"></i><b>13.2</b> Unbalanced box</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="testformean.html"><a href="testformean.html"><i class="fa fa-check"></i><b>14</b> Tests for a mean</a><ul>
<li class="chapter" data-level="14.1" data-path="testformean.html"><a href="testformean.html#sample-t-test"><i class="fa fa-check"></i><b>14.1</b> 1 sample t-test</a><ul>
<li class="chapter" data-level="14.1.1" data-path="testformean.html"><a href="testformean.html#h-hypotheses"><i class="fa fa-check"></i><b>14.1.1</b> H: Hypotheses</a></li>
<li class="chapter" data-level="14.1.2" data-path="testformean.html"><a href="testformean.html#a-check-the-assumptions"><i class="fa fa-check"></i><b>14.1.2</b> A: Check the Assumptions</a></li>
<li class="chapter" data-level="14.1.3" data-path="testformean.html"><a href="testformean.html#t-calculate-the-test-statistic"><i class="fa fa-check"></i><b>14.1.3</b> T: Calculate the Test Statistic</a></li>
<li class="chapter" data-level="14.1.4" data-path="testformean.html"><a href="testformean.html#p-calculate-the-p-value"><i class="fa fa-check"></i><b>14.1.4</b> P: Calculate the p-value</a></li>
<li class="chapter" data-level="14.1.5" data-path="testformean.html"><a href="testformean.html#c-conclusion"><i class="fa fa-check"></i><b>14.1.5</b> C: Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="testformean.html"><a href="testformean.html#the-speedy-way"><i class="fa fa-check"></i><b>14.2</b> The speedy way!</a></li>
<li class="chapter" data-level="14.3" data-path="testformean.html"><a href="testformean.html#sample-z-test"><i class="fa fa-check"></i><b>14.3</b> 1 sample Z-Test**</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="testsforrelationships.html"><a href="testsforrelationships.html"><i class="fa fa-check"></i><b>15</b> Tests for relationships</a><ul>
<li class="chapter" data-level="15.1" data-path="testsforrelationships.html"><a href="testsforrelationships.html#more-t-tests"><i class="fa fa-check"></i><b>15.1</b> More t-tests</a><ul>
<li class="chapter" data-level="15.1.1" data-path="testsforrelationships.html"><a href="testsforrelationships.html#sleep-data-zzzzzzz"><i class="fa fa-check"></i><b>15.1.1</b> Sleep data zzzzzzz</a></li>
<li class="chapter" data-level="15.1.2" data-path="testsforrelationships.html"><a href="testsforrelationships.html#sample-t-test-1"><i class="fa fa-check"></i><b>15.1.2</b> 2 sample t-test</a></li>
<li class="chapter" data-level="15.1.3" data-path="testsforrelationships.html"><a href="testsforrelationships.html#sample-t-test-paired-data"><i class="fa fa-check"></i><b>15.1.3</b> 1 sample t-test (paired data)</a></li>
</ul></li>
<li><a href="testsforrelationships.html#chi-squared-tests-goodness-of-fit-test-1-variable-test-for-independence-2-variables-1-sample-test-for-homogeneity-2-variables-2-samples-regression-test"><span class="toc-section-number">15.2</span> Chi-squared tests **
### Goodness of Fit Test (1 variable)
### Test for independence (2 variables; 1 sample)
### Test for Homogeneity (2 variables; 2 samples)
## Regression test</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="morerelationships.html"><a href="morerelationships.html"><i class="fa fa-check"></i><b>16</b> More tests for relationships (Diagnostics)</a><ul>
<li class="chapter" data-level="16.1" data-path="morerelationships.html"><a href="morerelationships.html#test-normality-for-1-populations-histogram-qq-plot-shapiro-wilks-test"><i class="fa fa-check"></i><b>16.1</b> Test normality for 1+ populations: histogram, QQ-plot, Shapiro-Wilks Test</a></li>
<li class="chapter" data-level="16.2" data-path="morerelationships.html"><a href="morerelationships.html#test-equal-variance-of-2-populations-boxplots-f-test-variance-ratio"><i class="fa fa-check"></i><b>16.2</b> Test equal variance of 2 populations (Boxplots; F-test; variance ratio)</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="faq.html"><a href="faq.html"><i class="fa fa-check"></i><b>17</b> FAQs</a><ul>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#why-am-i-getting-weird-variable-names"><i class="fa fa-check"></i>Why am I getting weird variable names?</a></li>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#how-do-i-produce-a-residual-plot-with-missing-values-in-data"><i class="fa fa-check"></i>How do I produce a residual plot with missing values in data?</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">RGuide</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="morerelationships" class="section level1">
<h1><span class="header-section-number">Chapter 16</span> More tests for relationships (Diagnostics)</h1>
<p>We can use hypothesis tests to test the assumptions of other hypothesis tests!</p>
<p><br></p>
<div id="test-normality-for-1-populations-histogram-qq-plot-shapiro-wilks-test" class="section level2">
<h2><span class="header-section-number">16.1</span> Test normality for 1+ populations: histogram, QQ-plot, Shapiro-Wilks Test</h2>
<p>Here we illustrate using the car weights.</p>
<ol style="list-style-type: decimal">
<li>Check the <strong>histogram</strong>.</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">hist</span>(mtcars<span class="op">$</span>wt, <span class="dt">main =</span> <span class="st">&quot;Histogram of Car Weights&quot;</span>, <span class="dt">freq=</span>F)</a></code></pre></div>
<ul>
<li>Note: The histogram is roughly normal (roughly balanced around one mode towards the centre).</li>
</ul>
<p><br></p>
<ol start="2" style="list-style-type: decimal">
<li>Check the <strong>QQ-plot</strong>.</li>
</ol>
<ul>
<li>A QQ-plot is another summary for quantitative variables. Further information can be found <a href="https://en.wikipedia.org/wiki/Q-Q_plot">here</a>.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">help</span>(qqnorm)</a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">qqnorm</span>(mtcars<span class="op">$</span>wt, <span class="dt">main =</span> <span class="st">&quot;QQ-plot for Car weights&quot;</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">qqline</span>(mtcars<span class="op">$</span>wt, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<ul>
<li>Note: The data is reasonably evenly scattered around the theoretical quantile-quantile line which suggests that the car weights are reasonably normally distributed.</li>
</ul>
<p><br></p>
<ol start="3" style="list-style-type: decimal">
<li>Test using the <strong>Shapiro-Wilks Test</strong></li>
</ol>
<ul>
<li><p>Warning! <a href="https://academic.oup.com/biomet/article-abstract/52/3-4/591/336553?redirectedFrom=fulltext">The Shapiro-Wilks normality test</a> is sensitive to sample size. Small samples will nearly always pass normality tests. Therefore, it is recomended to use both visual inspection and a significance test to decide whether a dataset is normally distributed.</p></li>
<li><strong>H:</strong>
<ul>
<li><span class="math inline">\(H_{0}\)</span> : The data is <em>normally</em> distributed.</li>
<li><span class="math inline">\(H_{1}\)</span> : There data is <em>not normally</em> distributed.</li>
<li>We hope to retain <span class="math inline">\(H_{0}\)</span>!</li>
</ul></li>
<li><p><strong>T,P&amp;C:</strong></p></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">shapiro.test</span>(mtcars<span class="op">$</span>wt)</a></code></pre></div>
<p>Note: The p-value is much greater than 0.05, so strong evidence that the data is normally distributed.</p>
<p><br></p>
</div>
<div id="test-equal-variance-of-2-populations-boxplots-f-test-variance-ratio" class="section level2">
<h2><span class="header-section-number">16.2</span> Test equal variance of 2 populations (Boxplots; F-test; variance ratio)</h2>
<ol style="list-style-type: decimal">
<li>Compare the <strong>2 boxplots</strong>.</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">boxplot</span>(extra<span class="op">~</span>group, <span class="dt">data =</span> sleep)</a></code></pre></div>
<ul>
<li><p>Note: It is clear from the boxplots that the variation in group 1 is less than group 2.</p></li>
<li><p>Boxplots are a very useful tool as they provide an indication of whether the sample means are similar or different, whether the samples are normally distributed, and whether the variances are similar between the 2 samples.</p></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Test using the <strong>Variance Test (Levene)</strong></li>
</ol>
<ul>
<li><p><strong>H:</strong></p>
<ul>
<li><p>Let <span class="math inline">\(\sigma_1^2\)</span> = variance of the group 1 drug.</p></li>
<li><p>Let <span class="math inline">\(\sigma_2^2\)</span> = variance of the group 2 drug.</p></li>
<li><p><span class="math inline">\(H_{0}\)</span> : There is no difference: <span class="math inline">\(\sigma_1^2=\sigma_2^2\)</span></p></li>
<li><p><span class="math inline">\(H_{1}\)</span> : There is a difference: <span class="math inline">\(\sigma_1^2 \neq \sigma_2^2\)</span></p></li>
<li><p>We hope to retain <span class="math inline">\(H_{0}\)</span>!</p></li>
</ul></li>
<li><p><strong>T,P&amp;C</strong></p></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">var.test</span>(extra<span class="op">~</span>group, <span class="dt">data =</span> sleep)</a></code></pre></div>
<p>Note: From the variance test, it is clear that the p-value is much greater than 0.05. Therefore we retain the null hypothesis and conclude that the variances seem to be equal.</p>
<!--
## Test normality for 2 populations: histogram, QQ-plot, Shapiro-Wilks Test

- Produce a **histogram** of the increase in hours of sleep.

```r
par(mfrow = c(1,2))
hist(sleep$extra[sleep$group==1], main = "Group1", xlab = "Increase in hours of sleep", freq=F)
hist(sleep$extra[sleep$group==2], main = "Group2", xlab = "Increase in hours of sleep", freq=F)
```

<br>

While there appears to be no significant skew in the group1 or group2 data, it is rather hard to tell as the sample size is small. Therefore, it is useful to look at a number of other ways to check the normality assumoption.

<br>

- Produce a **QQ-plot**
A QQ-plot is another summary for quantitative variables. 

Read the help for the qqnorm function. Further information can be found [here](https://en.wikipedia.org/wiki/Q-Q_plot).


```r
help(qqnorm)
```

Produce a **QQ-plot** for the sleep data.

```r
par(mfrow = c(1,2))
qqnorm(sleep$extra[sleep$group==1], main = "Group1")
qqline(sleep$extra[sleep$group==1], col = "blue")
qqnorm(sleep$extra[sleep$group==2], main = "Group2")
qqline(sleep$extra[sleep$group==2], col = "blue")
```

<br>

The plots show that the data is reasonably evenly scattered around the theoretical quantile-quantile line which suggests that the data is reasonably normally distributed.

<br>

- Test using the **Shapiro-Wilks Test**

Warning! [The Shapiro-Wilks normality test](https://academic.oup.com/biomet/article-abstract/52/3-4/591/336553?redirectedFrom=fulltext) is sensitive to sample size. Small samples will nearly always pass normality tests. Therefore, it is recomended to use both visual inspection and a significance test to decide whether a dataset is normally distributed.

- $H_{0}$ : The data is *normally* distributed. =(We hope to retain $H_{0}$.)

- $H_{1}$ : There data is *not normally* distributed.


```r
shapiro.test(sleep$extra[sleep$group==1])
shapiro.test(sleep$extra[sleep$group==2])
```

In both cases the p-value is much greater than 0.05 so the data is likely to be normally distributed.
-->
<!--
## Get organised

It's very important to set up a neat file management system for the semester. This is best practise, and will make your life easier!

### Create a course folder [one-off]

- Create a course folder on your Desktop. eg `DATA1001files`. 

<div align="center">
<img src="figure/DATA1001folderfiles1.jpg" width="30%" height="30%">
</div>

### Create a project  [one-off]

- Create a project and save it as `DATA1001` in `~Desktop/DATA1001files`.

<div align="center">
<img src="figure/OpenProject.jpg" width="30%" height="30%">
<img src="figure/PickNewProject.jpg" width="40%" height="40%">
<img src="figure/PickNewDirectory.jpg" width="40%" height="40%">
<img src="figure/NameProject2.jpg" width="30%" height="30%">
</div>

- It will appear in your Files in RStudio as `DATA1001.Rproj`.

<div align="center">
<img src="figure/RconsolewithProject2.jpg" width="50%" height="50%">
</div>

- It will also appear as a sub-folder (containing DATA1001.Rproj) in the `DATA1001` folder.

<div align="center">
<img src="figure/Lab1subfolder1.jpg" width="30%" height="30%">
</div>

### Create a data folder  [one-off]

- Create a subfolder in the `DATA1001` folder called `data` to keep all your datasets.

- You should end up with the following file hierachy, which we'll use all semester.

<div align="center">
<img src="figure/Lab1subfolder2.jpg" width="30%" height="30%">
</div>

- The good thing about having a project, is that when you open it, all the linked files (eg data) automatically open in RStudio.

- Store your  `Lab1.Rmd` file in the `DATA1001` folder, so that it is linked to the project.

<br>

### Create your own RMarkdown document (for a Project or Lab)

- The easiest way to create new RMarkdown files is to duplicate `Lab1.Rmd` and rename it `Lab2.Rmd` or `Project1.Rmd` etc.

- Alternatively , you can follow the steps below.

    - Open your project (this needs to be done at the beginning of each new session in RStudio).


    - Create a new .Rmd file by either duplicating the given `Lab1.Rmd` file, or by following th stopes 

<div align="center">
<img src="figure/rmd2.jpg" width="70%" height="70%">
</div>

    - You will have an example file, which you can edit. 

<div align="center">
<img src="figure/RmdEg.jpg" width="70%" height="70%">
</div>

    - Name the file: `Lab1.Rmd`.

<div align="center">
<img src="figure/RmdSaveAs.jpg" width="20%" height="20%">
</div>

    - Render  the file using `Knit`.
<div align="center">
<img src="figure/RmdKnit.jpg" width="30%" height="30%">
</div>

    - This will create `Lab1.html`, which you can open in a browser. 
\
<div align="center">
<img src="figure/Rmdhtml.jpg" width="60%" height="60%">
</div>

    - It will appear in your `DATA1001files/DATA1001` folder as `Lab1.html`.
<div align="center">
<img src="figure/Lab1htmlinproject.jpg" width="30%" height="30%">
</div>

<br>

## It's easy from then!

- Once you have set up your project `DATA1001.Rproj`, then in subsequent Labs all you need to do is open that project, and then create a new RMarkdown document, eg `Lab2.Rmd`. 
- Everything will automatically be stored in the `DATA1001` folder, as the project sets that as the working directory.

--->
<!-- See for example  and some of the articles cited therein: 

Moser, B.K. and Stevens, G.R., 1992. Homogeneity of variance in the two-sample means test. The American Statistician, 46(1), pp.19-21.

Ruxton, G.D., 2006. The unequal variance t-test is an underused alternative to Student's t-test and the Mann-Whitney U test. Behavioral Ecology, 17(4), pp.688-690.
-->
<!--

- The following table records hair and eye colour for both male and female statistics students, from the  `HairEyeColor` dataset.

- To simplify things we use the `apply` function to combine gender into one class.


```r
# Male and Female separate tables
HairEyeColor

# Male and Female combined into 1 table
require(knitr)
HairEyeColor1 <- apply(HairEyeColor, c(1, 2), sum)
HairEyeColor1
kable(HairEyeColor1)
```

A nice way to plot categorical data is the mosaic plot. The size of each block is in proportion to the cell frequency in the "contingency" table. Generally we can say that if the gaps between the blocks line up, then the data is independent. More on this later!

Cell frequency: number of individuals in a group i.e. females with brown eyes and brown hair.

Contingency table (two way table): Is a table that is used to summarize the relationship between several categorical variables.


```r
mosaicplot(HairEyeColor1, main = "Relation between hair and eye color", shade = F)
```

One of the key reasons for collecting such data is to look for relationships or lack of relationships between the categories. For example, do more blond haired people have blue eyes than expected?

The key word in this sentence is **expected**. Let's take a look at a simple example to understand what this means. Let's say that we conduct a simple survey of 100 people, 50 male and 50 female. Of the 100 people surveyed, 60 answer yes and 40 answer no. Then we would expect 30 of each females and males to answer Yes (total 60) and 20 of each to answer no (total 40). 

This might remind you of the probability lessons where, in this case, we can think of the the totals columns as determining the probability of answering yes or no (0.6 and 0.4 respectively). In this example, we also would expect that the probability is the same for females and males. So if we ask 50 females the question we would expect 30 to answer yes and 20 to answer no as with the males. We can easily calculate the expected frequency using the following formula:

$Expected = \frac{RowTotal \times ColumnTotal}{GrandTotal}$

---|Yes|No|Total
---|---|---|---
Female|30|20|50
Male|30|20|50
Total|60|40|100

After we go out and do the actual survey we get the following values

---|Yes|No|Total
---|---|---|---
Female|40|10|50
Male|15|35|50
Total|60|40|100

It looks as though more females answered yes to this question and more males answered no. The question is whether this difference from the expected values is big enough to assume that females preference is different from males, or is it purely by random chance? 

This is where the chi-squared statistic $(\chi^2)$ comes in useful. Using it we can determine the probability of whether the observations are independent of each other (you can think of it like the two sample populations follow different probabilities, one is weighted towards yes and the other no). Like with the t-test, the bigger the value of $(\chi^2)$ the smaller the probability that the two sample populations are dependent. This brings a new test the chi-squared test aka Pearson's chi-squared test.

The Pearson's chi-squared test is a very versatile test and can be used to:

1. Test the goodness of fit of a distribution to theoretical distribution (similar purpose to the Shapiro-Wilks test for normality) or model. In the goodness-of-fit test there is only one observed variable!

2. Test for homogeneity.

3. Test for independence.

The test statistic itself is 

\[\chi^2=\mbox{Sum of}[ \frac{(\mbox{Observed frequency - Expected frequency})^2}{\mbox{Expected frequency}} ] \]

Basically it is a measure of the weighted distance between the observed and expected values. The bigger it is the more likely it is that the observed and expected values are not the same.

-->

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="testsforrelationships.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="faq.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/16-more-relationships.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["RGuide_Bookdown.pdf", "RGuide_Bookdown.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
